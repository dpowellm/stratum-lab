============================= test session starts =============================
platform win32 -- Python 3.12.10, pytest-9.0.2, pluggy-1.6.0 -- C:\Users\dpowe\AppData\Local\Programs\Python\Python312\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\dpowe\OneDrive\Documents\Coding Projects\stratum-observability\stratum-lab
configfile: pyproject.toml
plugins: anyio-4.12.1
collecting ... collected 122 items

eval/test_audit_risk_model.py::TestEventCompleteness::test_event_completeness_perfect PASSED [  0%]
eval/test_audit_risk_model.py::TestEventCompleteness::test_event_completeness_partial PASSED [  1%]
eval/test_audit_risk_model.py::TestSeparationOfDuties::test_separation_self_review PASSED [  2%]
eval/test_audit_risk_model.py::TestSeparationOfDuties::test_separation_good PASSED [  3%]
eval/test_audit_risk_model.py::TestDecisionTraceability::test_traceability_with_routing PASSED [  4%]
eval/test_audit_risk_model.py::TestDecisionTraceability::test_traceability_no_outputs PASSED [  4%]
eval/test_audit_risk_model.py::TestRegulatoryMapping::test_regulatory_mapping_strat_hc PASSED [  5%]
eval/test_audit_risk_model.py::TestRegulatoryMapping::test_regulatory_mapping_strat_pl PASSED [  6%]
eval/test_audit_risk_model.py::TestAuditReadinessScore::test_audit_readiness_score_bounds PASSED [  7%]
eval/test_audit_risk_model.py::TestAuditReadinessScore::test_frameworks_at_risk PASSED [  8%]
eval/test_audit_risk_model.py::TestStateSequenceExtraction::test_state_sequence_extraction PASSED [  9%]
eval/test_audit_risk_model.py::TestDTMCLearning::test_dtmc_learning_basic PASSED [  9%]
eval/test_audit_risk_model.py::TestDTMCLearning::test_dtmc_laplace_smoothing PASSED [ 10%]
eval/test_audit_risk_model.py::TestViolationProbability::test_violation_probability_safe PASSED [ 11%]
eval/test_audit_risk_model.py::TestViolationProbability::test_violation_probability_risky PASSED [ 12%]
eval/test_audit_risk_model.py::TestViolationProbability::test_violation_probability_unknown_state PASSED [ 13%]
eval/test_audit_risk_model.py::TestPACBound::test_pac_confidence_bound PASSED [ 13%]
eval/test_audit_risk_model.py::TestFindingViolationProbabilities::test_finding_violation_probabilities PASSED [ 14%]
eval/test_defensive_patterns.py::TestDefensivePatternScanner::test_detects_timeout_guard PASSED [ 15%]
eval/test_defensive_patterns.py::TestDefensivePatternScanner::test_detects_pydantic_output_validation PASSED [ 16%]
eval/test_defensive_patterns.py::TestDefensivePatternScanner::test_detects_bare_except PASSED [ 17%]
eval/test_defensive_patterns.py::TestDefensivePatternScanner::test_handles_binary_files PASSED [ 18%]
eval/test_defensive_patterns.py::TestDefensivePatternScanner::test_summary_counts_correct PASSED [ 18%]
eval/test_defensive_patterns.py::TestDefensivePatternScanner::test_detects_concurrency_controls PASSED [ 19%]
eval/test_defensive_patterns.py::TestDefensivePatternScanner::test_detects_rate_limiting PASSED [ 20%]
eval/test_defensive_patterns.py::TestDefensivePatternScanner::test_near_delegation_boundary_detection PASSED [ 21%]
eval/test_defensive_patterns.py::TestDefensivePatternScanner::test_prompt_constraints_in_strings PASSED [ 22%]
eval/test_defensive_patterns.py::TestDefensivePatternScanner::test_specific_exception_classified PASSED [ 22%]
eval/test_defensive_patterns.py::TestDefensivePatternScanner::test_max_files_cap PASSED [ 23%]
eval/test_end_to_end.py::test_end_to_end PASSED                          [ 24%]
eval/test_integration_semantic_pipeline.py::TestPhase0FeedsPass5::test_defended_nodes_have_lower_vulnerability PASSED [ 25%]
eval/test_integration_semantic_pipeline.py::TestAllPassesStructuredOutput::test_five_passes_with_five_runs PASSED [ 26%]
eval/test_integration_semantic_pipeline.py::TestPassFailureIsolation::test_pass1_crash_does_not_block_pass3_and_pass5 PASSED [ 27%]
eval/test_integration_semantic_pipeline.py::TestFullFlowRemediation::test_output_validation_emerges_as_remediation PASSED [ 27%]
eval/test_patchers.py::test_eventlogger_basics PASSED                    [ 28%]
eval/test_patchers.py::test_eventlogger_v6_features PASSED               [ 29%]
eval/test_patchers.py::test_helper_functions PASSED                      [ 30%]
eval/test_patchers.py::test_patcher_imports PASSED                       [ 31%]
eval/test_patchers.py::test_patched_flags PASSED                         [ 31%]
eval/test_patchers.py::test_event_types_emitted PASSED                   [ 32%]
eval/test_permissions_cost.py::TestClassifyToolPermissions::test_classify_read_tool PASSED [ 33%]
eval/test_permissions_cost.py::TestClassifyToolPermissions::test_classify_write_tool PASSED [ 34%]
eval/test_permissions_cost.py::TestClassifyToolPermissions::test_classify_dangerous_tool PASSED [ 35%]
eval/test_permissions_cost.py::TestTransitiveClosure::test_transitive_closure_simple PASSED [ 36%]
eval/test_permissions_cost.py::TestTransitiveClosure::test_transitive_closure_chain PASSED [ 36%]
eval/test_permissions_cost.py::TestEscalation::test_escalation_detected PASSED [ 37%]
eval/test_permissions_cost.py::TestEscalation::test_no_escalation_same_perms PASSED [ 38%]
eval/test_permissions_cost.py::TestAsymmetries::test_asymmetry_risk_critical PASSED [ 39%]
eval/test_permissions_cost.py::TestUnusedPermissions::test_unused_permissions_detected PASSED [ 40%]
eval/test_permissions_cost.py::TestPermissionBlastRadius::test_permission_blast_radius_score PASSED [ 40%]
eval/test_permissions_cost.py::TestTokenAmplification::test_token_amplification_basic PASSED [ 41%]
eval/test_permissions_cost.py::TestTokenAmplification::test_token_amplification_single_node PASSED [ 42%]
eval/test_permissions_cost.py::TestToolCallDensity::test_tool_call_density PASSED [ 43%]
eval/test_permissions_cost.py::TestRetryWaste::test_retry_waste_detection PASSED [ 44%]
eval/test_permissions_cost.py::TestRetryWaste::test_retry_waste_zero_errors PASSED [ 45%]
eval/test_permissions_cost.py::TestLatencyProfile::test_latency_profile PASSED [ 45%]
eval/test_permissions_cost.py::TestCostRiskScoring::test_cost_risk_score_bounds PASSED [ 46%]
eval/test_permissions_cost.py::TestCostRiskScoring::test_cost_finding_triggered PASSED [ 47%]
eval/test_permissions_cost.py::TestCostRiskScoring::test_cost_finding_not_triggered PASSED [ 48%]
eval/test_permissions_cost.py::TestCostRiskScoring::test_monthly_cost_multiplier PASSED [ 49%]
eval/test_privacy_topology.py::TestClassifyDataDomain::test_classify_single_domain PASSED [ 50%]
eval/test_privacy_topology.py::TestClassifyDataDomain::test_classify_multi_domain PASSED [ 50%]
eval/test_privacy_topology.py::TestClassifyDataDomain::test_classify_generic_fallback PASSED [ 51%]
eval/test_privacy_topology.py::TestFanIn::test_fan_in_single_source PASSED [ 52%]
eval/test_privacy_topology.py::TestFanIn::test_fan_in_high_risk PASSED   [ 53%]
eval/test_privacy_topology.py::TestCrossDomainFlows::test_cross_domain_flow_detected PASSED [ 54%]
eval/test_privacy_topology.py::TestCrossDomainFlows::test_no_cross_domain_same_type PASSED [ 54%]
eval/test_privacy_topology.py::TestPrivacyScoring::test_privacy_exposure_score_bounds PASSED [ 55%]
eval/test_privacy_topology.py::TestPrivacyScoring::test_finding_triggered_above_threshold PASSED [ 56%]
eval/test_privacy_topology.py::TestPrivacyScoring::test_finding_not_triggered_below PASSED [ 57%]
eval/test_privacy_topology.py::TestNodeDataDomains::test_node_data_domains_union PASSED [ 58%]
eval/test_privacy_topology.py::TestNodeDataDomains::test_empty_tool_registrations PASSED [ 59%]
eval/test_privacy_topology.py::TestNodeDataDomains::test_state_key_classification PASSED [ 59%]
eval/test_privacy_topology.py::TestFullPrivacyTopology::test_full_privacy_topology PASSED [ 60%]
eval/test_privacy_topology.py::TestFullPrivacyTopology::test_compute_privacy_handles_missing_nodes PASSED [ 61%]
eval/test_privacy_topology.py::TestFullPrivacyTopology::test_heterogeneous_detection PASSED [ 62%]
eval/test_remediation_mining.py::TestPartitioning::test_partitions_correctly PASSED [ 63%]
eval/test_remediation_mining.py::TestPartitioning::test_empty_records PASSED [ 63%]
eval/test_remediation_mining.py::TestPartitioning::test_all_q1 PASSED    [ 64%]
eval/test_remediation_mining.py::TestPartitioning::test_has_pattern_with_sub_features PASSED [ 65%]
eval/test_remediation_mining.py::TestPartitioning::test_has_pattern_missing PASSED [ 66%]
eval/test_remediation_mining.py::TestPatternDifferential::test_detects_significant_differential PASSED [ 67%]
eval/test_remediation_mining.py::TestPatternDifferential::test_ignores_small_samples PASSED [ 68%]
eval/test_remediation_mining.py::TestPatternDifferential::test_no_differential_when_equal PASSED [ 68%]
eval/test_remediation_mining.py::TestTopologyConditional::test_enriches_candidates_with_topology PASSED [ 69%]
eval/test_remediation_mining.py::TestPriorityScoring::test_higher_severity_higher_priority PASSED [ 70%]
eval/test_remediation_mining.py::TestPriorityScoring::test_interaction_multiplier PASSED [ 71%]
eval/test_remediation_mining.py::TestPriorityScoring::test_higher_effort_lower_priority PASSED [ 72%]
eval/test_remediation_mining.py::TestPriorityScoring::test_zero_reduction_uses_fallback PASSED [ 72%]
eval/test_remediation_mining.py::TestCrossPatternInteractions::test_detects_co_occurrences PASSED [ 73%]
eval/test_remediation_mining.py::TestCrossPatternInteractions::test_no_interactions_when_no_co_occurrences PASSED [ 74%]
eval/test_remediation_mining.py::TestRationaleGeneration::test_generates_nonempty_rationale PASSED [ 75%]
eval/test_remediation_mining.py::TestRationaleGeneration::test_rationale_empty_candidate PASSED [ 76%]
eval/test_remediation_mining.py::TestStatisticalFunctions::test_chi2_manual_basic PASSED [ 77%]
eval/test_remediation_mining.py::TestStatisticalFunctions::test_chi2_manual_equal PASSED [ 77%]
eval/test_remediation_mining.py::TestStatisticalFunctions::test_chi2_manual_empty PASSED [ 78%]
eval/test_remediation_mining.py::TestStatisticalFunctions::test_chi2_contingency_wrapper PASSED [ 79%]
eval/test_remediation_mining.py::TestStatisticalFunctions::test_ttest_ind_different_means PASSED [ 80%]
eval/test_remediation_mining.py::TestStatisticalFunctions::test_ttest_ind_small_samples PASSED [ 81%]
eval/test_semantic_analysis.py::TestPass1DelegationFidelity::test_detects_hedging_loss PASSED [ 81%]
eval/test_semantic_analysis.py::TestPass1DelegationFidelity::test_skips_short_outputs PASSED [ 82%]
eval/test_semantic_analysis.py::TestPass1DelegationFidelity::test_handles_llm_parse_error PASSED [ 83%]
eval/test_semantic_analysis.py::TestPass1DelegationFidelity::test_multiple_edges_multiple_runs PASSED [ 84%]
eval/test_semantic_analysis.py::TestPass2Consistency::test_computes_stability_score PASSED [ 85%]
eval/test_semantic_analysis.py::TestPass2Consistency::test_handles_missing_repeat_runs PASSED [ 86%]
eval/test_semantic_analysis.py::TestPass2Consistency::test_with_sufficient_runs PASSED [ 86%]
eval/test_semantic_analysis.py::TestPass5Vulnerability::test_terminal_node_higher_vulnerability PASSED [ 87%]
eval/test_semantic_analysis.py::TestPass5Vulnerability::test_defenses_reduce_vulnerability PASSED [ 88%]
eval/test_semantic_analysis.py::TestPass5Vulnerability::test_isolated_nodes_low_vulnerability PASSED [ 89%]
eval/test_semantic_analysis.py::TestAggregateScores::test_oer_estimate_increases_with_trust_elevation PASSED [ 90%]
eval/test_semantic_analysis.py::TestAggregateScores::test_handles_empty_passes PASSED [ 90%]
eval/test_semantic_analysis.py::TestAggregateScores::test_mast_failure_distribution PASSED [ 91%]
eval/test_semantic_analysis.py::TestScoringFunctions::test_delegation_fidelity_perfect PASSED [ 92%]
eval/test_semantic_analysis.py::TestScoringFunctions::test_delegation_fidelity_poor PASSED [ 93%]
eval/test_semantic_analysis.py::TestScoringFunctions::test_stability_score_range PASSED [ 94%]
eval/test_semantic_analysis.py::TestValidators::test_validate_pass1_fills_defaults PASSED [ 95%]
eval/test_semantic_analysis.py::TestValidators::test_validate_pass2_fills_defaults PASSED [ 95%]
eval/test_semantic_analysis.py::TestValidators::test_validate_pass3_fills_defaults PASSED [ 96%]
eval/test_semantic_analysis.py::TestValidators::test_validate_pass4_fills_defaults PASSED [ 97%]
eval/test_semantic_analysis.py::TestHelperFunctions::test_extract_delegation_edges_explicit PASSED [ 98%]
eval/test_semantic_analysis.py::TestHelperFunctions::test_extract_node_outputs PASSED [ 99%]
eval/test_semantic_analysis.py::TestHelperFunctions::test_build_delegation_chain PASSED [100%]

============================= 122 passed in 3.23s =============================
